pop: iad1
mode: enforced

http:
  listen: "0.0.0.0:8080"
  auth:
    mode: none
  # cors_origin: "http://localhost:3000"  # Only needed without a reverse proxy
  rate_limit:
    events_per_second: 100
    burst: 500

bgp:
  mode: sidecar
  gobgp_grpc: "gobgp:50051"
  local_asn: 65010
  router_id: "10.10.0.10"
  neighbors: []

guardrails:
  require_ttl: true
  dst_prefix_minlen: 32
  dst_prefix_maxlen: 32
  # IPv6 prefix length limits (default: 128)
  # dst_prefix_minlen_v6: 128
  # dst_prefix_maxlen_v6: 128
  max_ports: 8
  allow_src_prefix_match: false

quotas:
  max_active_per_customer: 5
  max_active_per_pop: 200
  max_active_global: 500
  max_new_per_minute: 30

timers:
  default_ttl_seconds: 120
  min_ttl_seconds: 30
  max_ttl_seconds: 1800
  correlation_window_seconds: 300
  reconciliation_interval_seconds: 30

escalation:
  enabled: true
  min_persistence_seconds: 120
  min_confidence: 0.7

storage:
  # DATABASE_URL env var takes precedence over this value
  # For docker-compose, DATABASE_URL is set automatically
  connection_string: "postgres://user:password@localhost:5432/prefixd"

observability:
  log_format: pretty
  log_level: info
  audit_log_path: "./data/audit.jsonl"
  metrics_listen: "0.0.0.0:9090"

safelist:
  prefixes:
    - "10.0.0.0/8"
    - "192.168.0.0/16"

shutdown:
  drain_timeout_seconds: 30
  preserve_announcements: true

# alerting:
#   destinations:
#     - type: slack
#       webhook_url: "https://hooks.slack.com/services/T.../B.../xxx"
#       channel: "#ddos-alerts"
#     - type: discord
#       webhook_url: "https://discord.com/api/webhooks/123/abc"
#     - type: teams
#       webhook_url: "https://prod-XX.westus.logic.azure.com/..."
#     - type: telegram
#       bot_token: "${TELEGRAM_BOT_TOKEN}"
#       chat_id: "-100123456789"
#     - type: pagerduty
#       routing_key: "${PAGERDUTY_ROUTING_KEY}"
#     - type: opsgenie
#       api_key: "${OPSGENIE_API_KEY}"
#       region: "us"
#     - type: generic
#       url: "https://example.com/webhook"
#       secret: "${WEBHOOK_SECRET}"
#       headers:
#         X-Custom: "value"
#   events:
#     - mitigation.created
#     - mitigation.escalated
#     - mitigation.withdrawn
#     - mitigation.expired
