// Mock data for screenshot mode - matches API response types exactly
import type { Mitigation, Event, Stats, HealthResponse, SafelistEntry, AuditEntry } from "./api"

// Helper to generate ISO timestamps relative to now
const now = new Date()
const ago = (minutes: number) => new Date(now.getTime() - minutes * 60 * 1000).toISOString()
const inFuture = (minutes: number) => new Date(now.getTime() + minutes * 60 * 1000).toISOString()

export const mockHealth: HealthResponse = {
  status: "healthy",
  version: "0.8.0",
  pop: "iad1",
  uptime_seconds: 86400,
  bgp_sessions: { "172.30.30.3": "established" },
  active_mitigations: 6,
  database: "connected",
  gobgp: { status: "connected" },
  bgp_session_up: true,
}

export const mockStats: Stats = {
  total_active: 6,
  total_mitigations: 847,
  total_events: 12847,
  pops: [
    { pop: "iad1", active: 4, total: 523 },
    { pop: "ord1", active: 1, total: 198 },
    { pop: "lax1", active: 1, total: 126 },
  ],
}

export const mockMitigations: Mitigation[] = [
  {
    mitigation_id: "f47ac10b-58cc-4372-a567-0e02b2c3d479",
    scope_hash: "a1b2c3d4e5f6",
    status: "active",
    customer_id: "cust_acme",
    service_id: "svc_dns",
    pop: "iad1",
    victim_ip: "203.0.113.10",
    vector: "udp_flood",
    action_type: "police",
    rate_bps: 5000000,
    dst_prefix: "203.0.113.10/32",
    protocol: 17,
    dst_ports: [53],
    created_at: ago(2),
    updated_at: ago(2),
    expires_at: inFuture(3),
    withdrawn_at: null,
    triggering_event_id: "evt-001",
    reason: "UDP flood detected by FastNetMon",
  },
  {
    mitigation_id: "550e8400-e29b-41d4-a716-446655440001",
    scope_hash: "f6e5d4c3b2a1",
    status: "active",
    customer_id: "cust_techstart",
    service_id: "svc_web",
    pop: "iad1",
    victim_ip: "198.51.100.25",
    vector: "syn_flood",
    action_type: "discard",
    rate_bps: null,
    dst_prefix: "198.51.100.25/32",
    protocol: 6,
    dst_ports: [80, 443],
    created_at: ago(5),
    updated_at: ago(5),
    expires_at: inFuture(10),
    withdrawn_at: null,
    triggering_event_id: "evt-002",
    reason: "SYN flood attack detected",
  },
  {
    mitigation_id: "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
    scope_hash: "123456789abc",
    status: "escalated",
    customer_id: "cust_globalnet",
    service_id: "svc_dns_primary",
    pop: "iad1",
    victim_ip: "192.0.2.100",
    vector: "ntp_amplification",
    action_type: "police",
    rate_bps: 10000000,
    dst_prefix: "192.0.2.100/32",
    protocol: 17,
    dst_ports: [123],
    created_at: ago(15),
    updated_at: ago(8),
    expires_at: inFuture(45),
    withdrawn_at: null,
    triggering_event_id: "evt-003",
    reason: "NTP amplification attack - escalated due to sustained volume",
  },
  {
    mitigation_id: "6ba7b811-9dad-11d1-80b4-00c04fd430c9",
    scope_hash: "def789abc123",
    status: "active",
    customer_id: "cust_securehost",
    service_id: null,
    pop: "ord1",
    victim_ip: "10.0.50.75",
    vector: "dns_amplification",
    action_type: "police",
    rate_bps: 2000000,
    dst_prefix: "10.0.50.75/32",
    protocol: 17,
    dst_ports: [53],
    created_at: ago(8),
    updated_at: ago(8),
    expires_at: inFuture(2),
    withdrawn_at: null,
    triggering_event_id: "evt-004",
    reason: "DNS amplification attack detected",
  },
  {
    mitigation_id: "6ba7b812-9dad-11d1-80b4-00c04fd430ca",
    scope_hash: "789abcdef012",
    status: "active",
    customer_id: "cust_cloudscale",
    service_id: "svc_api",
    pop: "iad1",
    victim_ip: "203.0.113.50",
    vector: "memcached_amplification",
    action_type: "police",
    rate_bps: 50000000,
    dst_prefix: "203.0.113.50/32",
    protocol: 17,
    dst_ports: [11211],
    created_at: ago(3),
    updated_at: ago(3),
    expires_at: inFuture(12),
    withdrawn_at: null,
    triggering_event_id: "evt-006",
    reason: "Memcached amplification attack",
  },
  {
    mitigation_id: "6ba7b813-9dad-11d1-80b4-00c04fd430cb",
    scope_hash: "abcdef012345",
    status: "active",
    customer_id: "cust_mediastream",
    service_id: "svc_streaming",
    pop: "lax1",
    victim_ip: "198.51.100.100",
    vector: "ssdp_amplification",
    action_type: "discard",
    rate_bps: null,
    dst_prefix: "198.51.100.100/32",
    protocol: 17,
    dst_ports: [1900],
    created_at: ago(1),
    updated_at: ago(1),
    expires_at: inFuture(4),
    withdrawn_at: null,
    triggering_event_id: "evt-007",
    reason: "SSDP amplification attack - full discard applied",
  },
]

export const mockEvents: Event[] = [
  {
    event_id: "evt-001",
    external_event_id: "fnm-12345",
    source: "fastnetmon",
    event_timestamp: ago(2),
    ingested_at: ago(2),
    victim_ip: "203.0.113.10",
    vector: "udp_flood",
    protocol: 17,
    bps: 1200000000,
    pps: 250000,
    top_dst_ports_json: "[53]",
    confidence: 0.95,
  },
  {
    event_id: "evt-002",
    external_event_id: "fnm-12346",
    source: "fastnetmon",
    event_timestamp: ago(5),
    ingested_at: ago(5),
    victim_ip: "198.51.100.25",
    vector: "syn_flood",
    protocol: 6,
    bps: 800000000,
    pps: 180000,
    top_dst_ports_json: "[80, 443]",
    confidence: 0.92,
  },
  {
    event_id: "evt-003",
    external_event_id: null,
    source: "noc_manual",
    event_timestamp: ago(15),
    ingested_at: ago(15),
    victim_ip: "192.0.2.100",
    vector: "ntp_amplification",
    protocol: 17,
    bps: 5000000000,
    pps: 500000,
    top_dst_ports_json: "[123]",
    confidence: 0.98,
  },
  {
    event_id: "evt-004",
    external_event_id: "fnm-12347",
    source: "fastnetmon",
    event_timestamp: ago(8),
    ingested_at: ago(8),
    victim_ip: "10.0.50.75",
    vector: "dns_amplification",
    protocol: 17,
    bps: 600000000,
    pps: 120000,
    top_dst_ports_json: "[53]",
    confidence: 0.88,
  },
  {
    event_id: "evt-005",
    external_event_id: "fnm-12348",
    source: "fastnetmon",
    event_timestamp: ago(25),
    ingested_at: ago(25),
    victim_ip: "10.0.100.200",
    vector: "udp_flood",
    protocol: 17,
    bps: 300000000,
    pps: 80000,
    top_dst_ports_json: "[53, 123]",
    confidence: 0.65,
  },
  {
    event_id: "evt-006",
    external_event_id: "fnm-12349",
    source: "fastnetmon",
    event_timestamp: ago(3),
    ingested_at: ago(3),
    victim_ip: "203.0.113.50",
    vector: "memcached_amplification",
    protocol: 17,
    bps: 2500000000,
    pps: 350000,
    top_dst_ports_json: "[11211]",
    confidence: 0.97,
  },
  {
    event_id: "evt-007",
    external_event_id: "fnm-12350",
    source: "fastnetmon",
    event_timestamp: ago(1),
    ingested_at: ago(1),
    victim_ip: "198.51.100.100",
    vector: "ssdp_amplification",
    protocol: 17,
    bps: 1800000000,
    pps: 280000,
    top_dst_ports_json: "[1900]",
    confidence: 0.91,
  },
  {
    event_id: "evt-008",
    external_event_id: "fnm-12351",
    source: "fastnetmon",
    event_timestamp: ago(12),
    ingested_at: ago(12),
    victim_ip: "172.16.0.50",
    vector: "icmp_flood",
    protocol: 1,
    bps: 400000000,
    pps: 600000,
    top_dst_ports_json: "[]",
    confidence: 0.82,
  },
]

export const mockAuditLog: AuditEntry[] = [
  {
    audit_id: "aud-001",
    timestamp: ago(1),
    schema_version: 1,
    actor_type: "system",
    actor_id: "prefixd-iad1",
    action: "mitigation_created",
    target_type: "mitigation",
    target_id: "6ba7b813-9dad-11d1-80b4-00c04fd430cb",
    details: { victim_ip: "198.51.100.100", vector: "ssdp_amplification", action: "discard" },
  },
  {
    audit_id: "aud-002",
    timestamp: ago(2),
    schema_version: 1,
    actor_type: "system",
    actor_id: "prefixd-iad1",
    action: "mitigation_created",
    target_type: "mitigation",
    target_id: "f47ac10b-58cc-4372-a567-0e02b2c3d479",
    details: { victim_ip: "203.0.113.10", vector: "udp_flood", action: "police", rate_bps: 5000000 },
  },
  {
    audit_id: "aud-003",
    timestamp: ago(3),
    schema_version: 1,
    actor_type: "system",
    actor_id: "prefixd-iad1",
    action: "mitigation_created",
    target_type: "mitigation",
    target_id: "6ba7b812-9dad-11d1-80b4-00c04fd430ca",
    details: { victim_ip: "203.0.113.50", vector: "memcached_amplification", action: "police" },
  },
  {
    audit_id: "aud-004",
    timestamp: ago(8),
    schema_version: 1,
    actor_type: "operator",
    actor_id: "admin@noc",
    action: "mitigation_escalated",
    target_type: "mitigation",
    target_id: "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
    details: { victim_ip: "192.0.2.100", reason: "Sustained attack volume" },
  },
  {
    audit_id: "aud-005",
    timestamp: ago(15),
    schema_version: 1,
    actor_type: "system",
    actor_id: "prefixd-iad1",
    action: "mitigation_created",
    target_type: "mitigation",
    target_id: "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
    details: { victim_ip: "192.0.2.100", vector: "ntp_amplification", action: "police" },
  },
  {
    audit_id: "aud-006",
    timestamp: ago(25),
    schema_version: 1,
    actor_type: "system",
    actor_id: "prefixd-iad1",
    action: "event_rejected",
    target_type: "event",
    target_id: "evt-005",
    details: { victim_ip: "10.0.100.200", reason: "Confidence below threshold", confidence: 0.65 },
  },
  {
    audit_id: "aud-007",
    timestamp: ago(45),
    schema_version: 1,
    actor_type: "operator",
    actor_id: "ops@noc",
    action: "mitigation_extended",
    target_type: "mitigation",
    target_id: "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
    details: { victim_ip: "192.0.2.100", extended_by_minutes: 30 },
  },
  {
    audit_id: "aud-008",
    timestamp: ago(90),
    schema_version: 1,
    actor_type: "system",
    actor_id: "prefixd-iad1",
    action: "mitigation_withdrawn",
    target_type: "mitigation",
    target_id: "old-mit-001",
    details: { victim_ip: "172.16.0.50", reason: "TTL expired" },
  },
]

export const mockSafelist: SafelistEntry[] = [
  {
    prefix: "10.0.0.0/8",
    reason: "Internal network - never mitigate",
    added_by: "system",
    added_at: "2026-01-01T00:00:00Z",
    expires_at: null,
  },
  {
    prefix: "192.168.0.0/16",
    reason: "Private network",
    added_by: "system",
    added_at: "2026-01-01T00:00:00Z",
    expires_at: null,
  },
  {
    prefix: "10.10.0.1/32",
    reason: "Router loopback - iad1-rtr-01",
    added_by: "netops@example.com",
    added_at: "2026-01-10T14:30:00Z",
    expires_at: null,
  },
  {
    prefix: "10.10.0.2/32",
    reason: "Router loopback - iad1-rtr-02",
    added_by: "netops@example.com",
    added_at: "2026-01-10T14:30:00Z",
    expires_at: null,
  },
]

export const mockPops: import("./api").PopInfo[] = [
  { pop: "iad1", active_mitigations: 4, total_mitigations: 523 },
  { pop: "ord1", active_mitigations: 1, total_mitigations: 198 },
  { pop: "lax1", active_mitigations: 1, total_mitigations: 126 },
]
